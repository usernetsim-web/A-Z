<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Игра: Назови номер буквы (по-русски)</title>
<style>
  body {
    margin: 0; padding: 0;
    font-family: Arial, sans-serif;
    background: #121212;
    color: #eee;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    user-select: none;
    overflow: hidden;
  }
  #letter {
    font-size: 10rem;
    font-weight: bold;
    margin-bottom: 1rem;
    user-select: none;
    opacity: 0;
    transition: opacity 0.7s ease;
  }
  #letter.visible {
    opacity: 1;
  }
  #prompt {
    font-size: 1.5rem;
    margin-bottom: 1rem;
    text-align: center;
  }
  #feedback {
    min-height: 2.5rem;
    font-size: 1.3rem;
    margin-bottom: 2rem;
    text-align: center;
    user-select: none;
  }
  #btnSpeak {
    font-size: 1.2rem;
    padding: 0.7rem 1.5rem;
    border: none;
    border-radius: 8px;
    background-color: #0a84ff;
    color: white;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.3s ease;
  }
  #btnSpeak.listening {
    background-color: #ff3b30;
  }
  /* Анимация "вылетающей" буквы */
  @keyframes flyAway {
    0% {
      opacity: 1;
      transform: translate(0, 0) scale(1) rotate(0deg);
    }
    100% {
      opacity: 0;
      transform: translate(var(--dx), var(--dy)) scale(2) rotate(var(--dr));
    }
  }
  .fly-away {
    position: absolute;
    font-size: 10rem;
    font-weight: bold;
    color: #0af;
    user-select: none;
    pointer-events: none;
    animation: flyAway 1.2s forwards ease-out;
    z-index: 1000;
    left: 50%;
    top: 40%;
    transform: translate(-50%, -50%);
  }
</style>
</head>
<body>

<div id="letter">A</div>
<div id="prompt">Назовите порядковый номер буквы <strong>по-русски</strong> (от 1 до 26)</div>
<div id="feedback"></div>
<button id="btnSpeak">Запустить распознавание</button>

<audio id="soundCorrect" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg" preload="auto"></audio>
<audio id="soundError" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio>

<script>
(() => {
  const letterEl = document.getElementById('letter');
  const promptEl = document.getElementById('prompt');
  const feedbackEl = document.getElementById('feedback');
  const btnSpeak = document.getElementById('btnSpeak');
  const soundCorrect = document.getElementById('soundCorrect');
  const soundError = document.getElementById('soundError');

  const letters = Array.from({length:26}, (_,i) => String.fromCharCode(65 + i));

  const russianNumWords = {
    'ОДИН':1, 'ДВА':2, 'ТРИ':3, 'ЧЕТЫРЕ':4, 'ПЯТЬ':5, 'ШЕСТЬ':6, 'СЕМЬ':7, 'ВОСЕМЬ':8, 'ДЕВЯТЬ':9, 'ДЕСЯТЬ':10,
    'ОДИННАДЦАТЬ':11, 'ДВЕНАДЦАТЬ':12, 'ТРИНАДЦАТЬ':13, 'ЧЕТЫРНАДЦАТЬ':14, 'ПЯТНАДЦАТЬ':15, 'ШЕСТНАДЦАТЬ':16,
    'СЕМНАДЦАТЬ':17, 'ВОСЕМНАДЦАТЬ':18, 'ДЕВЯТНАДЦАТЬ':19, 'ДВАДЦАТЬ':20,
    'ДВАДЦАТЬ ОДИН':21, 'ДВАДЦАТЬ ОДНО':21, 'ДВАДЦАТЬ ДВА':22, 'ДВАДЦАТЬ ТРИ':23, 'ДВАДЦАТЬ ЧЕТЫРЕ':24,
    'ДВАДЦАТЬ ПЯТЬ':25, 'ДВАДЦАТЬ ШЕСТЬ':26
  };

  function findRussianNumber(text) {
    text = text.toUpperCase().trim();

    // Проверяем цифры 1-26
    let digitMatch = text.match(/\b([1-9]|1[0-9]|2[0-6])\b/);
    if (digitMatch) return parseInt(digitMatch[1], 10);

    // Проверяем числительные (составные тоже)
    // Например, "двадцать один"
    for (const [key, val] of Object.entries(russianNumWords)) {
      if (text === key) return val;
      if (text.startsWith(key + ' ')) return val;
    }
    return null;
  }

  let currentIndex = 0;

  function showLetter() {
    letterEl.classList.remove('visible');
    setTimeout(() => {
      currentIndex = Math.floor(Math.random() * letters.length);
      letterEl.textContent = letters[currentIndex];
      letterEl.classList.add('visible');
      feedbackEl.textContent = '';
      feedbackEl.style.color = '#eee';
    }, 300);
  }

  function animateFlyAwayLetter() {
    const flyEl = document.createElement('div');
    flyEl.className = 'fly-away';
    flyEl.textContent = letters[currentIndex];
    document.body.appendChild(flyEl);

    // Случайное направление и угол
    const dx = (Math.random() - 0.5) * 400 + 'px';
    const dy = (Math.random() - 0.5) * 400 + 'px';
    const dr = (Math.random() - 0.5) * 720 + 'deg';

    flyEl.style.setProperty('--dx', dx);
    flyEl.style.setProperty('--dy', dy);
    flyEl.style.setProperty('--dr', dr);

    flyEl.addEventListener('animationend', () => {
      flyEl.remove();
    });
  }

  // SpeechRecognition setup
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  if (!SpeechRecognition) {
    alert('Ваш браузер не поддерживает распознавание речи. Используйте Chrome или Edge.');
    btnSpeak.disabled = true;
    promptEl.textContent = 'Распознавание речи не поддерживается.';
    return;
  }

  const recognition = new SpeechRecognition();
  recognition.lang = 'ru-RU';
  recognition.interimResults = false;
  recognition.maxAlternatives = 1;
  recognition.continuous = true;

  recognition.onresult = (event) => {
    const transcript = event.results[event.results.length - 1][0].transcript;
    const number = findRussianNumber(transcript);
    if (number === null) {
      feedbackEl.style.color = '#ff5555';
      feedbackEl.textContent = `Не распознано число в ответе: "${transcript.trim()}"`;
      soundError.play();
      return;
    }
    if (number === currentIndex + 1) {
      feedbackEl.style.color = '#55ff55';
      feedbackEl.textContent = `Верно! Буква "${letters[currentIndex]}" — это номер ${number}`;
      soundCorrect.play();
      animateFlyAwayLetter();
      setTimeout(showLetter, 1500);
    } else {
      feedbackEl.style.color = '#ff5555';
      feedbackEl.textContent = `Неверно, попробуйте ещё раз. Вы сказали: ${number}`;
      soundError.play();
    }
  };

  recognition.onerror = (e) => {
    feedbackEl.style.color = '#ff5555';
    feedbackEl.textContent = 'Ошибка распознавания: ' + e.error;
  };

  recognition.onend = () => {
    if (btnSpeak.classList.contains('listening')) {
      recognition.start(); // перезапускаем для непрерывного прослушивания
    }
  };

  btnSpeak.addEventListener('click', () => {
    if (btnSpeak.classList.contains('listening')) {
      recognition.stop();
      btnSpeak.classList.remove('listening');
      btnSpeak.textContent = 'Запустить распознавание';
      promptEl.textContent = 'Распознавание остановлено.';
      feedbackEl.textContent = '';
    } else {
      recognition.start();
      btnSpeak.classList.add('listening');
      btnSpeak.textContent = 'Остановить распознавание';
      promptEl.textContent = 'Назовите порядковый номер буквы по-русски (от 1 до 26)';
      feedbackEl.textContent = '';
      showLetter();
    }
  });

  // Показываем первую букву сразу (не запуская распознавание)
  showLetter();

})();
</script>

</body>
</html>

Найти еще
